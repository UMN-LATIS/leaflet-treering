<html>
  <head>

    <script src="https://cdn.plot.ly/plotly-2.0.0-rc.2.min.js"></script>
    <script src="../assets/leaflet/dist/leaflet.js"></script>

    <style>
      #color {
        margin-left: 4%;
      }

      #files {
        margin-left: 4%;
        display: block;
      }

      p {
        margin: 0;
        margin-top: 2px;
      }

      .colorInput {
        margin: 0;
        margin-left: 20%;
        padding: 0;
        border: 0;
        width: 20px;
        height: 20px;
      }

    </style>

  </head>
  <body>

    <div id='plot' style='width:100%; height:90%'></div>
    <div id='files' style='width:100%;'>
      <p id='instructions'>Files inputted & color selection: </p>
    </div>
    <div id='color' style='width: 100%;'></div>

    <script id="script">
      var div = document.getElementById('plot');

      function createPlot (data, layout, config) {
        // main plot
        Plotly.newPlot(div, data, layout, config);

        var colorDiv = document.getElementById('color');
        for (child of colorDiv.childNodes) {
          colorDiv.removeChild(child);
        }

        var inputTable = document.createElement('table');

        // create color inputs to change line colors
        data.forEach((set, i) => {
          let inputRow = inputTable.insertRow(-1);

          let span = document.createElement('span');
          span.innerHTML = set.name;

          let input = document.createElement('input');
          input.className = 'colorInput';
          input.type = 'color';
          input.value = set.line.color || '#FFFFFF';
          input.addEventListener('change', () => {
            colorChange = {
              'line.color': input.value,
            }
            Plotly.restyle(div, colorChange, [i]);
          })

          var nameCell = inputRow.insertCell(-1);
          nameCell.appendChild(span);
          var colorCell = inputRow.insertCell(-1);
          colorCell.appendChild(input);
        })

        colorDiv.appendChild(inputTable);
      };

    </script>

  </body>
</html>
