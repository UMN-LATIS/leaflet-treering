<!DOCTYPE htmml>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="initial-scale=1">
	<title>Tree Rings</title>

    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css">
    <link rel="stylesheet" href="node_modules/font-awesome-4.7.0/css/font-awesome.css">

    <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap-theme.min.css" >

    <link rel="stylesheet" href="node_modules/leaflet/dist/leaflet.css">
    <link rel="stylesheet" href="node_modules/leaflet-fullscreen/dist/leaflet.fullscreen.css">
    <link rel="stylesheet" href="node_modules/leaflet-minimap/dist/Control.MiniMap.min.css" />
    <link rel="stylesheet" href="node_modules/leaflet-easybutton/src/easy-button.css" />
    <link rel="stylesheet" href="node_modules/leaflet-dialog/Leaflet.Dialog.css">

    <link rel="stylesheet" href="style.css">

    <script src="node_modules/jquery/dist/jquery.min.js"></script>
    <script src="node_modules/jszip/dist/jszip.min.js"></script>
    <script src="node_modules/file-saver/FileSaver.min.js"></script>

    <script src="node_modules/leaflet/dist/leaflet.js"></script>
    <script src="node_modules/leaflet-fullscreen/dist/Leaflet.fullscreen.js"></script>
    <script src="node_modules/leaflet-minimap/dist/Control.MiniMap.min.js"></script>
    <script src="node_modules/leaflet-easybutton/src/easy-button.js"></script>
    <script src="node_modules/leaflet-dialog/Leaflet.Dialog.js"></script>

    <script src="Leaflet.elevator.js"></script>
</head>

<body>
    <div id="map_container"><div id="imageMap"></div></div>
</body>
</html>
<script type="application/javascript" src="leaflet-treering.js"></script>

<script>
    var src;
    var map = L.map('imageMap', {
        fullscreenControl: true,
        zoomSnap: 0,
        crs: L.CRS.Simple,
        drawControl: true,
        layers: [],
        doubleClickZoom: false,
        zoomControl: false,
        trackResize: true
    }).setView([0, 0], 0);

    var layer = L.tileLayer.elevator(function(coords, tile, done) {
        var error;
        var params = {Bucket: 'elevator-assets', Key: "testasset7/tiledBase_files/" + coords.z + "/" + coords.x + "_" + coords.y + ".jpeg"};
        //var params = {Bucket: 'elevator-assets', Key: "pmc14b_files/" + coords.z + "/" + coords.x + "_" + coords.y + ".jpeg"};
        tile.onload = (function(done, error, tile) {
            return function() {
                done(error, tile);
            }
        })(done, error, tile);
        tile.src = "https://s3.amazonaws.com/" + params.Bucket + "/" + params.Key;
        //tile.src = params.Key;
        src = tile.src;
        return tile.src;
    },
    {
		width: 161686,
        height: 3922,
				//testasset5
        //width: 231782,
        //height: 4042,

        //width: 200521,
        //height: 4196,
        tileSize :254,
        maxNativeZoom: 18,
        maxZoom: 18,
        overlap: 1,
        pixelsPerMillimeter: 480, //(NEW)
        lineColor: 'blue'
    }).addTo(map);

    //minimap
    var miniLayer = new L.tileLayer.elevator(function(coords, tile, done) {
        var error;
        var params = {Bucket: 'elevator-assets', Key: "testasset7/tiledBase_files/" + coords.z + "/" + coords.x + "_" + coords.y + ".jpeg"};
        //var params = {Bucket: 'elevator-assets', Key: "pmc14b_files/" + coords.z + "/" + coords.x + "_" + coords.y + ".jpeg"};
        tile.onload = (function(done, error, tile) {
            return function() {
                done(error, tile)
            }
        })(done, error, tile);
        tile.src = "https://s3.amazonaws.com/" + params.Bucket + "/" + params.Key;
        //tile.src = params.Key;
        src = tile.src;
        return tile.src;
    },
    {
				width: 161686,
				height: 3922,
				//testasset5
				//width: 231782,
				//height: 4042,

        //width: 200521,
        //height: 4196,
        tileSize: 254,
        maxZoom: 14,
        overlap: 1,
    });

    //map, basepath, {ppm: int, saveURL: string, savePermission: bool, popoutUrl: string, assetName: string, hasLatewood: bool, initialData: json}
		//basepath is the local image folder location (i.e. replace "" with "file:///C:/Users/.../leaflet-treering")
		var treering = new LTreering(map, "", {'savePermission': true, 'saveURL': '/test', 'ppm':
    468, 'popoutUrl': "SpRln07c1_forward_annual.html", 'assetName': "SpRln07c1", 'hasLatewood': true,
    'initialData': {"SaveDate":{"day":5,"hour":1,"year":2021,"month":2,"minute":3},"year":2016,"forwardDirection":true,"subAnnual":false,"earlywood":true,"index":36,"points":[{"start":true,"skip":false,"break":false,"latLng":{"lat":-0.44066639072847646,"lng":0.07888814155629133}},{"start":false,"skip":false,"break":false,"year":1981,"earlywood":true,"latLng":{"lat":-0.4129863410596023,"lng":0.10795219370860917}},{"start":false,"skip":false,"break":false,"year":1982,"earlywood":true,"latLng":{"lat":-0.3910347987062985,"lng":0.1286262007148658}},{"start":false,"skip":false,"break":false,"year":1983,"earlywood":true,"latLng":{"lat":-0.3779352723063013,"lng":0.14256186709784152}},{"start":false,"skip":false,"break":false,"year":1984,"earlywood":true,"latLng":{"lat":-0.3656718858892827,"lng":0.15440718352337088}},{"start":false,"skip":false,"break":false,"year":1985,"earlywood":true,"latLng":{"lat":-0.35508077943822114,"lng":0.16694928326804903}},{"start":false,"skip":false,"break":false,"year":1986,"earlywood":true,"latLng":{"lat":-0.3418418963743942,"lng":0.1842295095829389}},{"start":false,"skip":false,"break":false,"year":1987,"earlywood":true,"latLng":{"lat":-0.3274881599999292,"lng":0.2017884492254883}},{"start":false,"skip":false,"break":false,"year":1988,"earlywood":true,"latLng":{"lat":-0.3141099202722725,"lng":0.21781446556591036}},{"start":false,"skip":false,"break":false,"year":1989,"earlywood":true,"latLng":{"lat":-0.3025433171744027,"lng":0.234676621889311}},{"start":false,"skip":false,"break":false,"year":1990,"earlywood":true,"latLng":{"lat":-0.289722504102065,"lng":0.2512600648850521}},{"start":false,"skip":false,"break":false,"year":1991,"earlywood":true,"latLng":{"lat":-0.27634426437440834,"lng":0.2674254378893039}},{"start":false,"skip":false,"break":false,"year":1992,"earlywood":true,"latLng":{"lat":-0.2617118146722839,"lng":0.2842875942127045}},{"start":false,"skip":false,"break":false,"year":1993,"earlywood":true,"latLng":{"lat":-0.2512600648850521,"lng":0.2968296939573826}},{"start":false,"skip":false,"break":false,"year":1994,"earlywood":true,"latLng":{"lat":-0.24610386832335107,"lng":0.30365817048504073}},{"start":false,"skip":false,"break":false,"year":1995,"earlywood":true,"latLng":{"lat":-0.23802118182122514,"lng":0.3142492769361023}},{"start":false,"skip":false,"break":false,"year":1996,"earlywood":true,"latLng":{"lat":-0.22952042532760997,"lng":0.3228893900935472}},{"start":false,"skip":false,"break":false,"year":1997,"earlywood":true,"latLng":{"lat":-0.22227387880846258,"lng":0.3316688599148219}},{"start":false,"skip":false,"break":false,"year":1998,"earlywood":true,"latLng":{"lat":-0.21196148568506057,"lng":0.3450470996424786}},{"start":false,"skip":false,"break":false,"year":1999,"earlywood":true,"latLng":{"lat":-0.19677160932761703,"lng":0.36288475261268754}},{"start":false,"skip":false,"break":false,"year":2000,"earlywood":true,"latLng":{"lat":-0.17949138301272716,"lng":0.3811404755743857}},{"start":false,"skip":false,"break":false,"year":2001,"earlywood":true,"latLng":{"lat":-0.16527700330209194,"lng":0.39856005855310533}},{"start":false,"skip":false,"break":false,"year":2002,"earlywood":true,"latLng":{"lat":-0.1527349035574138,"lng":0.41319250825522985}},{"start":false,"skip":false,"break":false,"year":2003,"earlywood":true,"latLng":{"lat":-0.13364304061273707,"lng":0.43339922451054463}},{"start":false,"skip":false,"break":false,"year":2004,"earlywood":true,"latLng":{"lat":-0.1105098344169974,"lng":0.4568111440339438}},{"start":false,"skip":false,"break":false,"year":2005,"earlywood":true,"latLng":{"lat":-0.10284521790636075,"lng":0.4669841804935161}},{"start":false,"skip":false,"break":false,"year":2006,"earlywood":true,"latLng":{"lat":-0.09113925814466114,"lng":0.4811985602041513}},{"start":false,"skip":false,"break":false,"year":2007,"earlywood":true,"latLng":{"lat":-0.07399838849360102,"lng":0.5008478498041471}},{"start":false,"skip":false,"break":false,"year":2008,"earlywood":true,"latLng":{"lat":-0.06354663870636924,"lng":0.5150622295147823}},{"start":false,"skip":false,"break":false,"year":2009,"earlywood":true,"latLng":{"lat":-0.060759505429774104,"lng":0.5195216427573345}},{"start":false,"skip":false,"break":false,"year":2010,"earlywood":true,"latLng":{"lat":-0.0568575188425409,"lng":0.5250959093105247}},{"start":false,"skip":false,"break":false,"year":2011,"earlywood":true,"latLng":{"lat":-0.049471615659563775,"lng":0.5340147357956293}},{"start":false,"skip":false,"break":false,"year":2012,"earlywood":true,"latLng":{"lat":-0.04333992245105446,"lng":0.5425154922892444}},{"start":false,"skip":false,"break":false,"year":2013,"earlywood":true,"latLng":{"lat":-0.03665080258722612,"lng":0.553106598740306}},{"start":false,"skip":false,"break":false,"year":2014,"earlywood":true,"latLng":{"lat":-0.03288817266382268,"lng":0.5586808652934963}},{"start":false,"skip":false,"break":false,"year":2015,"earlywood":true,"latLng":{"lat":-0.025780982808505066,"lng":0.5667635517956222}}],"annotations":{},"ppm":1140.1060934178372}});
treering.loadInterface();
</script>
